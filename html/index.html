<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="pageTitle">Pruebas Digitales</title>
    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <!-- Hojas de estilo -->
    <link rel="stylesheet" href="/css/mainStyle.css" />
    <link rel="stylesheet" href="/css/footerStyle.css" />
    <link rel="stylesheet" href="/css/authModal.css" />
    <link rel="stylesheet" href="/css/userKeysModal.css" />
    <link rel="stylesheet" href="/css/noKeysmodal.css" />
    <link rel="stylesheet" href="/css/profileMenu.css" />
    <link rel="stylesheet" href="/css/tutorial.css" />

    <link rel="stylesheet" href="/css/sections/inicioSection.css" />
    <link rel="stylesheet" href="/css/sections/firmarSection.css" />
    <link rel="stylesheet" href="/css/sections/verificarSection.css" />
    <link rel="stylesheet" href="/css/sections/contactoSection.css" />
    <link rel="stylesheet" href="/css/sections/perfilSection.css" />
    
    <!-- CSS del Sistema de Plantillas -->
    <link rel="stylesheet" href="/css/professionalPDF.css" />

    <link rel="stylesheet" href="/css/Header/headerStyle.css" />

    <!-- Sistema de Temas Dinámicos -->
    <link rel="stylesheet" href="/css/themeSelector.css" />
    <link rel="stylesheet" href="/css/Header/hHamburguer_new.css" />

    <!-- CSS para módulo de eliminación de llaves -->
    <link rel="stylesheet" href="/css/deleteKey.css" />

    <!-- CSS para personalización visual -->
    <link rel="stylesheet" href="/admin/css/secciones/backgrounds.css" />

  </head>

  <body style="visibility: hidden" data-bg="fondo1">
    <!-- Header con menú de autenticación -->
    <header>
      <div class="header-left">
        <a href="#inicio" class="logo-link">
          <img
            src="../recursos/logotipo-de-github.png"
            alt="Logo"
            class="logo-img"
          />
          <span id="tituloWeb" class="site-title header-title" data-institution-name>Pruebas Digitales</span>
        </a>
      </div>
      <!-- Navegación movida al menú hamburguesa -->
      <div class="header-right">
        <!-- (Selector de temas movido al flotante) -->
        <!-- Botón hamburguesa moderno -->
        <button
          id="headerMenuBtn"
          class="header-menu-btn"
          aria-label="Abrir menú de navegación"
          aria-expanded="false"
        >
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>

    <!-- Modal de confirmación para navegación -->
    <div id="navigationConfirmModal" class="navigation-confirm-modal">
      <div class="navigation-confirm-backdrop"></div>
      <div class="navigation-confirm-content">
        <div class="navigation-confirm-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
        </div>
        <h3 class="navigation-confirm-title">¿Estás seguro?</h3>
        <p class="navigation-confirm-message">
          Tienes un proceso en curso. Si continúas, perderás todos los cambios
          no guardados.
        </p>
        <div class="navigation-confirm-buttons">
          <button
            id="confirmNavigationBtn"
            class="navigation-confirm-btn primary"
          >
            Sí, continuar
          </button>
          <button
            id="cancelNavigationBtn"
            class="navigation-confirm-btn secondary"
          >
            Cancelar
          </button>
        </div>
      </div>
    </div>

    <!-- Menú móvil hamburguesa -->
    <div id="headerMobileMenu" class="header-mobile-menu" aria-hidden="true">
      <ul id="mobileMenuList"></ul>
    </div>

    <!-- Modal de Tutorial de Uso -->
    <div id="tutorialModal" class="tutorial-modal">
      <div class="tutorial-modal-content">
        <h2>Guía de Prueba: Sistema de Firmas Digitales</h2>
        <div class="tutorial-intro">
          <p>
            <strong>¡Bienvenido al entorno de prueba!</strong> Sigue estos pasos
            para probar todas las funcionalidades del sistema:
          </p>
          <p>
            <strong>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 4px;
                "
              >
                <rect
                  x="3"
                  y="11"
                  width="18"
                  height="11"
                  rx="2"
                  ry="2"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <circle
                  cx="12"
                  cy="16"
                  r="1"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="M7 11V7a5 5 0 0 1 10 0v4"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Seguridad garantizada:</strong
            >
            Todos los datos, archivos y llaves están protegidos con cifrado
            militar AES-256. Tu información está completamente segura.
          </p>
        </div>
        <ol>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <path
                  d="M17 3C17.2626 2.73735 17.5744 2.52901 17.9176 2.38687C18.2608 2.24473 18.6286 2.17157 19 2.17157C19.3714 2.17157 19.7392 2.24473 20.0824 2.38687C20.4256 2.52901 20.7374 2.73735 21 3C21.2626 3.26264 21.471 3.57444 21.6131 3.9176C21.7553 4.26077 21.8284 4.62856 21.8284 5C21.8284 5.37143 21.7553 5.73923 21.6131 6.08239C21.471 6.42555 21.2626 6.73735 21 7L7.5 20.5L2 22L3.5 16.5L17 3Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Paso 1: Regístrate en el sistema
            </b>
            <div>
              Crea tu cuenta de usuario haciendo clic en "Iniciar Sesión" →
              "Regístrate aquí". Usa tus datos reales para la encuesta:
              <em
                >Nombre: Tu nombre y apellido completo, Usuario:
                tu_usuario_preferido</em
              >
              <br /><strong>
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  style="
                    display: inline-block;
                    vertical-align: middle;
                    margin-right: 4px;
                  "
                >
                  <rect
                    x="8"
                    y="2"
                    width="8"
                    height="4"
                    rx="1"
                    ry="1"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
                Importante:</strong
              >
              Usa tu nombre real para identificar quién realizó la prueba y
              evaluación del sistema.
            </div>
          </li>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <rect
                  x="3"
                  y="11"
                  width="18"
                  height="11"
                  rx="2"
                  ry="2"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <circle
                  cx="12"
                  cy="16"
                  r="1"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="M7 11V7a5 5 0 0 1 10 0v4"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Paso 2: Genera tu primera llave digital
            </b>
            <div>
              Ve a la sección <strong>"Perfil"</strong> y genera tus llaves
              criptográficas. Usa una contraseña simple para prueba como
              <em>"1234"</em>. Tu primera llave se seleccionará automáticamente.
              <br /><strong>
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  style="
                    display: inline-block;
                    vertical-align: middle;
                    margin-right: 4px;
                  "
                >
                  <path
                    d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
                Seguridad:</strong
              >
              Todos los datos y archivos subidos están cifrados y protegidos. Tu
              información está segura en el sistema.
            </div>
          </li>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <path
                  d="M17 3C17.2626 2.73735 17.5744 2.52901 17.9176 2.38687C18.2608 2.24473 18.6286 2.17157 19 2.17157C19.3714 2.17157 19.7392 2.24473 20.0824 2.38687C20.4256 2.52901 20.7374 2.73735 21 3C21.2626 3.26264 21.471 3.57444 21.6131 3.9176C21.7553 4.26077 21.8284 4.62856 21.8284 5C21.8284 5.37143 21.7553 5.73923 21.6131 6.08239C21.471 6.42555 21.2626 6.73735 21 7L7.5 20.5L2 22L3.5 16.5L17 3Z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Paso 3: Firma un documento de prueba
            </b>
            <div>
              Ve a <strong>"Firmar"</strong> y sube cualquier archivo PDF de
              prueba. El sistema generará un documento firmado y avalado que
              podrás descargar.
            </div>
          </li>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <circle
                  cx="11"
                  cy="11"
                  r="8"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="m21 21-4.35-4.35"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Paso 4: Verifica tu propia firma
            </b>
            <div>
              Ve a <strong>"Verificar"</strong>, selecciona tu nombre como
              profesor, sube el PDF original y el firmado que acabas de crear.
              ¡Verifica que tu propia firma es válida!
            </div>
          </li>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <polyline
                  points="20,6 9,17 4,12"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Paso 5: Valida el resultado
            </b>
            <div>
              El sistema te mostrará si la firma es válida, quién la hizo y
              cuándo. Esto demuestra la autenticidad e integridad del documento.
            </div>
          </li>
          <li>
            <b>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                style="
                  display: inline-block;
                  vertical-align: middle;
                  margin-right: 8px;
                "
              >
                <circle
                  cx="12"
                  cy="12"
                  r="3"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Paso 6: Explora funciones adicionales
            </b>
            <div>
              Prueba crear múltiples llaves, cambiar tipos de cifrado, verificar
              documentos de otros usuarios, y gestionar tus llaves desde el
              perfil.
            </div>
          </li>
        </ol>
        <div class="tutorial-footer">
          <p>
            <strong>💡 Consejo:</strong> Este es un entorno de prueba seguro con
            cifrado avanzado. Experimenta libremente - todos tus datos están
            protegidos criptográficamente. <br /><strong>🔑 Privacidad:</strong>
            El sistema usa cifrado AES-256 para proteger archivos y llaves. Tus
            documentos y datos personales están completamente seguros.
          </p>
        </div>
        <button id="closeTutorialBtn" class="close-tutorial-btn">
          <svg
            class="btn-icon"
            width="16"
            height="16"
            viewBox="0 0 24 24"
            fill="none"
          >
            <path
              d="M22 11.08V12a10 10 0 1 1-5.93-9.14"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <polyline
              points="22,4 12,14.01 9,11.01"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          ¡Empezar a probar!
        </button>
      </div>
    </div>

    <!-- Modal de Login -->
    <div id="loginModal" class="auth-modal" style="display: none">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2>Iniciar Sesión</h2>
        <form id="loginForm">
          <input type="text" id="loginUsuario" placeholder="Usuario" required />
          <input
            type="password"
            id="loginPassword"
            placeholder="Contraseña"
            required
          />
          <button type="submit">
            <svg
              class="btn-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <polyline
                points="10,17 15,12 10,7"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <line
                x1="15"
                y1="12"
                x2="3"
                y2="12"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Iniciar Sesión
          </button>
        </form>
        <p id="loginError" class="error-message"></p>
        <p class="login-info">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="display: inline; margin-right: 6px; vertical-align: text-top;">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M12 16v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 8h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Para obtener acceso al sistema, contacta al administrador
        </p>
      </div>
    </div>

    <!-- Modal para seleccionar otra llave -->
    <div id="keySelectModal" class="modal" style="display: none">
      <div class="modal-content">
        <span id="closeKeySelectModal" class="close">&times;</span>
        <h3>Selecciona una llave para verificar</h3>
        <ul id="userKeysList"></ul>
        <div id="keyConfirmSection" style="display: none; margin-top: 16px">
          <p id="keyConfirmText"></p>
          <button id="confirmKeyBtn">
            <svg
              class="btn-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M20 6L9 17l-5-5"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Sí, usar esta llave
          </button>
          <button id="cancelKeyBtn" class="btn-secondary">
            <svg
              class="btn-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M18 6L6 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M6 6L18 18"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Cancelar
          </button>
        </div>
      </div>
    </div>

    <!-- Modal para contraseña de llave privada -->
    <div id="keyPasswordModal" class="auth-modal" style="display: none">
      <div class="modal-content">
        <span class="close-modal" id="closeKeyPasswordModal">&times;</span>
        <h2>Contraseña de la llave privada</h2>
        <form id="keyPasswordForm">
          <input
            type="password"
            id="keyPasswordInput"
            placeholder="Contraseña de la llave privada"
            required
            minlength="4"
          />
          <button type="submit" id="keyPasswordSubmitBtn">
            <svg
              class="btn-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M20 6L9 17l-5-5"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Aceptar
          </button>
        </form>
        <p id="keyPasswordError" style="color: red; display: none"></p>
      </div>
    </div>

    <!-- Modal para eliminar llave -->
    <div id="deleteKeyModal" class="delete-key-modal">
      <div class="delete-key-content">
        <button class="delete-key-close" id="deleteKeyClose">×</button>

        <div class="delete-key-header">
          <h2>
            <svg
              class="warning-icon"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              style="color: #dc3545"
            >
              <path
                d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Eliminar Llave Digital
          </h2>
        </div>

        <div class="delete-key-warning">
          <h3>
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              style="color: #dc3545"
            >
              <path
                d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Advertencia Importante
          </h3>
          <p>
            Está a punto de eliminar permanentemente la llave "<span
              id="deleteKeyName"
            ></span
            >".
          </p>
          <p>Al eliminar esta llave:</p>
          <ul>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <circle
                  cx="12"
                  cy="12"
                  r="10"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="M15 9l-6 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
                <path
                  d="M9 9l6 6"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
              <span
                ><strong>No podrá firmar más documentos</strong> con esta
                llave</span
              >
            </li>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <path
                  d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span
                ><strong
                  >Los documentos previamente firmados perderán
                  exclusividad</strong
                >
                de verificación</span
              >
            </li>
            <li>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                <rect
                  x="3"
                  y="11"
                  width="18"
                  height="11"
                  rx="2"
                  ry="2"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <path
                  d="M7 11V7a5 5 0 0 1 10 0v4"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              <span
                ><strong>Esta acción es irreversible</strong> y no se puede
                deshacer</span
              >
            </li>
            <li>
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                style="color: #6c757d"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <polyline
                  points="14,2 14,8 20,8"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <line
                  x1="16"
                  y1="13"
                  x2="8"
                  y2="13"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <line
                  x1="16"
                  y1="17"
                  x2="8"
                  y2="17"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <polyline
                  points="10,9 9,9 8,9"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              Se eliminará completamente de la base de datos
            </li>
          </ul>
        </div>

        <form id="deleteKeyForm" class="delete-key-form">
          <label for="deleteKeyPassword">
            Para confirmar, ingrese la contraseña con la que creó esta llave:
          </label>
          <input
            type="password"
            id="deleteKeyPassword"
            placeholder="Contraseña de la llave privada"
            required
            minlength="4"
            autocomplete="current-password"
          />
        </form>

        <div id="deleteKeyLoading" class="delete-key-loading">
          <div class="spinner"></div>
          Eliminando llave...
        </div>

        <div id="deleteKeyError" class="delete-key-error"></div>

        <div class="delete-key-actions">
          <button
            type="button"
            class="delete-key-btn delete-confirm-btn"
            id="deleteConfirmBtn"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Eliminar Llave
          </button>
          <button
            type="button"
            class="delete-key-btn delete-cancel-btn"
            id="deleteCancelBtn"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 6L6 18M6 6l12 12"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Cancelar
          </button>
        </div>
      </div>
    </div>

    <!-- Modal para guiar creación de llaves -->
    <div id="createKeysGuideModal" class="auth-modal" style="display: none">
      <div class="modal-content">
        <h2>
          <svg class="modal-icon" width="48" height="48" viewBox="0 0 24 24" fill="none">
            <path d="M12 1L21 5v6c0 5.55-3.84 10.74-9 12-5.16-1.26-9-6.45-9-12V5l9-4z" 
                  stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" 
                  stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Configuración Inicial
        </h2>
        <p class="modal-description">
          <strong>¡Bienvenido al sistema de firmas digitales!</strong><br>
          Para comenzar a usar todas las funcionalidades, necesitas configurar tus llaves criptográficas personales.
        </p>
        <div class="modal-subdescription">
          <div class="feature-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="16" r="1" stroke="currentColor" stroke-width="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>Las llaves son tu identidad digital y te permiten firmar documentos de forma segura.</span>
          </div>
          <div class="feature-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
              <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>Sin llaves no podrás firmar documentos, solo verificar firmas existentes.</span>
          </div>
          <div class="feature-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
            </svg>
            <span>El proceso es rápido y solo necesitas hacerlo una vez.</span>
          </div>
        </div>
        <div class="modal-buttons">
          <button id="goToCreateKeysBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
            Configurar Llaves
          </button>
          <button id="skipCreateKeysBtn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
            </svg>
            Más tarde
          </button>
        </div>
      </div>
    </div>

    <main class="content" role="main">
      <section id="inicioSection">
        <!-- Hero Section Principal -->
        <div class="hero-section">
          <div class="hero-content">
            <h1 class="hero-title">
              Firmas Digitales
              <span class="hero-highlight">Seguras y Confiables</span>
            </h1>
            <p class="hero-description">
              Plataforma profesional para la autenticación criptográfica de
              documentos de investigación. Protege la integridad de trabajos de
              investigación, proyectos científicos y documentos profesionales
              con tecnología de cifrado militar y firmas digitales.
            </p>
            <div class="hero-buttons">
              <button
                class="hero-btn primary"
                onclick="handleSignDocumentClick()"
              >
                <span class="btn-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M17 3C17.2626 2.73735 17.5744 2.52901 17.9176 2.38687C18.2608 2.24473 18.6286 2.17157 19 2.17157C19.3714 2.17157 19.7392 2.24473 20.0824 2.38687C20.4256 2.52901 20.7374 2.73735 21 3C21.2626 3.26264 21.471 3.57444 21.6131 3.9176C21.7553 4.26077 21.8284 4.62856 21.8284 5C21.8284 5.37143 21.7553 5.73923 21.6131 6.08239C21.471 6.42555 21.2626 6.73735 21 7L7.5 20.5L2 22L3.5 16.5L17 3Z"
                      stroke="white"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
                Firmar Documento
              </button>
              <button
                class="hero-btn secondary"
                onclick="window.location.hash='verificar'"
              >
                <span class="btn-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle
                      cx="11"
                      cy="11"
                      r="8"
                      stroke="white"
                      stroke-width="2"
                    />
                    <path
                      d="m21 21-4.35-4.35"
                      stroke="white"
                      stroke-width="2"
                    />
                  </svg>
                </span>
                Verificar Aval
              </button>
            </div>
            <div class="hero-stats">
              <div class="stat-item">
                <span class="stat-number">256-bit</span>
                <span class="stat-label">Cifrado AES</span>
              </div>
              <div class="stat-divider"></div>
              <div class="stat-item">
                <span class="stat-number">100%</span>
                <span class="stat-label">Seguro</span>
              </div>
              <div class="stat-divider"></div>
              <div class="stat-item">
                <span class="stat-number">RSA</span>
                <span class="stat-label">4096-bit</span>
              </div>
            </div>
          </div>
          <div class="hero-visual">
            <div class="floating-card">
              <div class="card-header">
                <span class="card-dot green"></span>
                <span class="card-dot yellow"></span>
                <span class="card-dot red"></span>
                <span class="card-title">documento_firmado.pdf</span>
              </div>
              <div class="card-content">
                <div class="signature-line">
                  <span class="sig-icon">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <rect
                        x="8"
                        y="2"
                        width="8"
                        height="4"
                        rx="1"
                        ry="1"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <path
                        d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                  <span class="sig-text">Documento Original</span>
                  <span class="sig-status verified">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <polyline
                        points="20,6 9,17 4,12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                </div>
                <div class="signature-line">
                  <span class="sig-icon">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <rect
                        x="3"
                        y="11"
                        width="18"
                        height="11"
                        rx="2"
                        ry="2"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <circle
                        cx="12"
                        cy="16"
                        r="1"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <path
                        d="M7 11V7a5 5 0 0 1 10 0v4"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                  <span class="sig-text">Firma Electrónica</span>
                  <span class="sig-status verified">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <polyline
                        points="20,6 9,17 4,12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                </div>
                <div class="signature-line">
                  <span class="sig-icon">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                  <span class="sig-text">Cifrado AES-256</span>
                  <span class="sig-status verified">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <polyline
                        points="20,6 9,17 4,12"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                </div>
                <div class="signature-line">
                  <span class="sig-icon"></span>
                  <span class="sig-text">Verificación</span>
                  <span class="sig-status processing">
                    <svg
                      width="12"
                      height="12"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <circle
                        cx="12"
                        cy="12"
                        r="10"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <polyline
                        points="12,6 12,12 16,14"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Separador visual -->
        <div class="section-separator">
          <div class="separator-content">
            <div class="separator-dots">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </div>
            <div class="separator-gradient-line"></div>
          </div>
        </div>

        <!-- Features Section -->
        <div class="features-section">
          <div class="section-header">
            <h2 class="section-title">¿Por qué elegir nuestro sistema?</h2>
            <p class="section-subtitle">
              Tecnología de vanguardia para la protección de documentos de
              investigación y trabajos científicos
            </p>
          </div>
          <div class="features-grid">
            <div class="feature-card">
              <div class="feature-icon-container">
                <span class="feature-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <rect
                      x="3"
                      y="11"
                      width="18"
                      height="11"
                      rx="2"
                      ry="2"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <circle
                      cx="12"
                      cy="16"
                      r="1"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="M7 11V7a5 5 0 0 1 10 0v4"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                </span>
                <div class="feature-icon-bg"></div>
              </div>
              <h3 class="feature-title">Máxima Seguridad</h3>
              <p class="feature-description">
                Cifrado militar AES-256, llaves RSA de 4096 bits, entre otros. Tus
                documentos están protegidos con la misma tecnología que usan
                bancos y gobiernos.
              </p>
              <div class="feature-tech">
                <span class="tech-badge">AES-256</span>
                <span class="tech-badge">RSA-4096</span>
              </div>
            </div>

            <div class="feature-card">
              <div class="feature-icon-container">
                <span class="feature-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle
                      cx="11"
                      cy="11"
                      r="8"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="m21 21-4.35-4.35"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                </span>
                <div class="feature-icon-bg"></div>
              </div>
              <h3 class="feature-title">Verificación Instantánea</h3>
              <p class="feature-description">
                Valida la autenticidad de cualquier documento en segundos.
                Detecta alteraciones y confirma la identidad del firmante de
                forma automática.
              </p>
              <div class="feature-tech">
                <span class="tech-badge">Tiempo Real</span>
                <span class="tech-badge">Automático</span>
              </div>
            </div>

            <div class="feature-card">
              <div class="feature-icon-container">
                <span class="feature-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <line
                      x1="3"
                      y1="6"
                      x2="21"
                      y2="6"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="M16 10a4 4 0 0 1-8 0"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                </span>
                <div class="feature-icon-bg"></div>
              </div>
              <h3 class="feature-title">Enfoque Investigativo</h3>
              <p class="feature-description">
                Diseñado para la comunidad académica e investigativa. Protege
                trabajos de investigación, estudios, papers, tesis y documentos
                de investigación profesional.
              </p>
              <div class="feature-tech">
                <span class="tech-badge">Investigativo</span>
                <span class="tech-badge">Científico</span>
              </div>
            </div>

            <div class="feature-card">
              <div class="feature-icon-container">
                <span class="feature-icon">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="M9 12l2 2 4-4"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                  </svg>
                </span>
                <div class="feature-icon-bg"></div>
              </div>
              <h3 class="feature-title">Validez Legal</h3>
              <p class="feature-description">
                Firmas Digitales con validez jurídica completa. Cumple con
                estándares internacionales y normativas de autenticación
                digital.
              </p>
              <div class="feature-tech">
                <span class="tech-badge">Legal</span>
                <span class="tech-badge">Internacional</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Separador visual -->
        <div class="section-separator">
          <div class="separator-content">
            <div class="separator-dots">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </div>
            <div class="separator-gradient-line"></div>
          </div>
        </div>

        <!-- Process Section -->
        <div class="process-section">
          <div class="section-header">
            <h2 class="section-title">Proceso Simple y Seguro</h2>
            <p class="section-subtitle">
              En solo 3 pasos, protege tus documentos con tecnología de
              vanguardia
            </p>
          </div>
          <ol class="process-timeline" aria-label="Proceso en tres pasos">
            <li class="timeline-item">
              <div class="timeline-side side-header">
                <div class="step-header">
                  <span class="step-badge">Paso 1</span>
                  <h3 class="step-title">Genera tus Llaves</h3>
                </div>
              </div>
              <div class="timeline-marker" aria-hidden="true">
                <!-- Key icon -->
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <circle
                    cx="7"
                    cy="12"
                    r="4"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="M11 12h10"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <path
                    d="M18 12v3"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <path
                    d="M16 12v2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
              <div class="timeline-side side-desc">
                <p class="step-desc">
                  Crea tu par de llaves criptográficas únicas. Una llave privada
                  (solo tuya) y una pública para verificación.
                </p>
              </div>
            </li>

            <li class="timeline-item">
              <div class="timeline-side side-desc">
                <p class="step-desc">
                  Sube tu PDF y aplica tu firma electrónica. El sistema genera un
                  hash único y lo cifra con tu llave privada.
                </p>
              </div>
              <div class="timeline-marker" aria-hidden="true">
                <!-- Pencil icon -->
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <path
                    d="M3 17.25V21h3.75L19.81 7.94l-3.75-3.75L3 17.25z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M14.06 4.19l3.75 3.75"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
              <div class="timeline-side side-header">
                <div class="step-header">
                  <span class="step-badge">Paso 2</span>
                  <h3 class="step-title">Firma el Documento</h3>
                </div>
              </div>
            </li>

            <li class="timeline-item">
              <div class="timeline-side side-header">
                <div class="step-header">
                  <span class="step-badge">Paso 3</span>
                  <h3 class="step-title">Verifica y Avala</h3>
                </div>
              </div>
              <div class="timeline-marker" aria-hidden="true">
                <!-- Magnifying glass icon -->
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  aria-hidden="true"
                >
                  <circle
                    cx="11"
                    cy="11"
                    r="7"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="m21 21-4.35-4.35"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
              <div class="timeline-side side-desc">
                <p class="step-desc">
                  Verifica la autenticidad con tu llave pública. El documento
                  queda avalado y protegido contra alteraciones.
                </p>
              </div>
            </li>
          </ol>
        </div>
      </section>

      <section id="firmarSection">
        <h2>Firmar Documento</h2>
        <p class="section-desc">
          Sube tu archivo PDF para firmarlo electrónicamente y obtener un aval que
          garantiza su autenticidad e integridad.
        </p>

        <!-- Indicador de pasos moderno -->
        <div id="signStepIndicator" class="step-indicator">
          <div class="step active" data-step="1" data-label="Seleccionar"></div>
          <div class="step" data-step="2" data-label="Firmar"></div>
          <div class="step" data-step="3" data-label="Firma Avalador"></div>
          <div class="step" data-step="4" data-label="Descargar"></div>
        </div>

        <!-- Paso 1: Selección de archivo -->
        <div id="signStep1" class="step-content">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                  <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                  <path d="M9 15l2 2 4-4" stroke="currentColor" stroke-width="1.5"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Seleccionar Documento</h3>
              <p class="step-description">Sube el archivo PDF que deseas firmar electrónicamente</p>
            </div>
          </div>

          <div class="step-main-content">
            <form id="signForm">
              <div class="upload-section">
                <div class="upload-content">
                  <h4 class="upload-title">Sube tu documento PDF</h4>
                  <p class="upload-subtitle">El archivo debe tener la extensión .pdf</p>
                  
                  <div class="modern-file-input-container">
                    <input
                      type="file"
                      id="fileInput"
                      accept=".pdf"
                      class="modern-file-input"
                      aria-label="Seleccionar archivo PDF"
                      required
                    />
                    <label for="fileInput" class="modern-file-label">
                      <div class="file-label-content">
                        <div class="file-icon">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                          </svg>
                        </div>
                        <div class="file-text">
                          <span class="file-main-text">Haz clic para seleccionar archivo</span>
                          <span class="file-sub-text">o arrastra y suelta aquí</span>
                        </div>
                      </div>
                    </label>
                  </div>

                  <div class="file-info" id="signFileInfo" style="display: none;">
                    <div class="file-info-content">
                      <div class="file-info-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                          <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </div>
                      <div class="file-details">
                        <div class="file-name-row">
                          <span class="file-name" id="signFileName">documento.pdf</span>
                          <button type="button" class="file-remove-btn" onclick="clearSignFile()" title="Eliminar archivo">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"/>
                            </svg>
                          </button>
                        </div>
                        <div class="file-size" id="signFileSize">0 KB</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Formulario de metadatos del documento -->
              <div class="document-metadata">
                <h4 class="upload-title">Información del documento</h4>
                <div class="metadata-form">
                  <div class="form-group">
                    <label for="docTitle">Título del trabajo</label>
                    <input
                      type="text"
                      id="docTitle"
                      name="docTitle"
                      placeholder="Título del documento (se detectará automáticamente)"
                      required
                    />
                  </div>
                  
                  <!-- Sistema dinámico de autores -->
                  <div class="form-group">
                    <label>Autores del documento</label>
                    <div class="authors-management">
                      <div id="documentAuthorsContainer" class="authors-container">
                        <!-- Los autores se generarán dinámicamente -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div style="display: flex; justify-content: center; margin-top: 24px">
                <button
                  type="button"
                  id="acceptDocumentBtn"
                  class="btn-primary"
                  disabled
                >
                  Continuar
                  <svg
                    class="btn-icon-right"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    aria-hidden="true"
                  >
                    <path
                      d="M6 12h12M14 8l4 4-4 4"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Paso 2: Selección de llave -->
        <div id="signStep2" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M6 10a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10z" stroke="currentColor" stroke-width="2"/>
                  <path d="M10 8V6a2 2 0 0 1 4 0v2" stroke="currentColor" stroke-width="2"/>
                  <circle cx="12" cy="15" r="1" fill="currentColor"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Seleccionar Llave</h3>
              <p class="step-description">Elige la llave digital que usarás para firmar el documento electrónicamente</p>
            </div>
          </div>

          <div class="step-main-content">
            <div class="key-selection-container">
              <div id="keysList" class="keys-list">
                <div class="loading-keys">
                  <span class="small-loader"></span>
                  <span>Cargando llaves...</span>
                </div>
              </div>
            </div>

            <div style="display: flex; justify-content: center; margin-top: 24px; gap: 16px;">
              <button
                id="signDocumentButton"
                class="btn-primary"
                style="display: none"
                disabled
              >
                <svg
                  class="btn-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                >
                  <path
                    d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                Firmar documento
              </button>
              
              <div id="signLoading" style="display: none" class="loading-container">
                <span class="loader"></span>
                <div class="loader-text">Firmando documento...</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Paso 3: Firma Electrónica del Avalador -->
        <div id="signStep3" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M7 10l5 5 10-10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M3 21h18M3 17h18M3 13h18" stroke="currentColor" stroke-width="1" opacity="0.3"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Firma Electrónica del Avalador</h3>
              <p class="step-description">Proporciona la firma electrónica del avalador que validará el documento</p>
            </div>
          </div>

          <div class="step-main-content">
            <div class="signature-options-container">
              <h4 class="upload-title">Añadir firma del avalador</h4>
              <p class="upload-subtitle">Elige cómo quieres proporcionar la firma electrónica</p>
              
              <!-- Selector de método de firma -->
              <div class="signature-method-selector">
                <div class="method-option active" data-method="draw">
                  <div class="method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                      <path d="M12 19l7-7 3 3-7 7-3-3z" stroke="currentColor" stroke-width="2"/>
                      <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 2l7.586 7.586" stroke="currentColor" stroke-width="2"/>
                      <circle cx="11" cy="11" r="2" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="method-content">
                    <h5>Dibujar Firma</h5>
                    <p>Dibuja la firma con el mouse o touch</p>
                  </div>
                </div>
                
                <div class="method-option" data-method="upload">
                  <div class="method-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                      <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </div>
                  <div class="method-content">
                    <h5>Subir Imagen</h5>
                    <p>Sube una foto de la firma</p>
                  </div>
                </div>
              </div>

              <!-- Área de dibujo de firma -->
              <div id="drawSignatureArea" class="signature-area">
                <div class="signature-canvas-container">
                  <canvas id="signatureCanvas" width="600" height="200"></canvas>
                  <div class="canvas-placeholder" id="canvasPlaceholder">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                      <path d="M12 19l7-7 3 3-7 7-3-3z" stroke="currentColor" stroke-width="2"/>
                      <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" stroke="currentColor" stroke-width="2"/>
                      <path d="M2 2l7.586 7.586" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <p>Dibuja la firma del avalador aquí</p>
                  </div>
                </div>
                <div class="signature-controls">
                  <button type="button" id="clearSignature" class="btn-outline small">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    Limpiar
                  </button>
                </div>
              </div>

              <!-- Área de subida de imagen -->
              <div id="uploadSignatureArea" class="signature-area" style="display: none;">
                <div class="modern-file-input-container">
                  <input
                    type="file"
                    id="signatureImageInput"
                    accept="image/*"
                    class="modern-file-input"
                    aria-label="Seleccionar imagen de firma"
                  />
                  <label for="signatureImageInput" class="modern-file-label">
                    <div class="file-label-content">
                      <div class="file-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                          <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                          <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                          <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </div>
                      <div class="file-text">
                        <span class="file-main-text">Seleccionar imagen de firma</span>
                        <span class="file-sub-text">PNG, JPG o JPEG</span>
                      </div>
                    </div>
                  </label>
                </div>

                <div class="file-info" id="signatureImageInfo" style="display: none;">
                  <div class="file-info-content">
                    <div class="signature-preview">
                      <img id="signatureImagePreview" alt="Vista previa de firma" />
                    </div>
                    <button type="button" class="file-remove-btn" onclick="clearSignatureImage()" title="Eliminar imagen">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <div style="display: flex; justify-content: center; margin-top: 24px; gap: 16px;">
              <button
                id="acceptSignatureBtn"
                class="btn-primary"
                disabled
              >
                Continuar con firma
                <svg
                  class="btn-icon-right"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  aria-hidden="true"
                >
                  <path
                    d="M6 12h12M14 8l4 4-4 4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Paso 4: Descarga (antes paso 3) -->
        <div id="signStep4" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper result-icon">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                  <path d="m9 12 2 2 4-4" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">¡Documento Firmado Exitosamente!</h3>
              <p class="step-description">Tu documento ha sido firmado electrónicamente y está listo para compartir. Puedes descargarlo o verificar la integridad de la firma en cualquier momento.</p>
            </div>
          </div>

          <div class="step-main-content">
            <div class="success-content">
              <div class="primary-actions">
                <button id="downloadSignedBtn" class="btn-primary download-btn">
                  <div class="btn-content">
                    <svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span class="btn-text">Descargar documento firmado</span>
                  </div>
                </button>
                
                <button id="goToVerifyBtn" class="btn-secondary verify-btn">
                  <div class="btn-content">
                    <svg class="btn-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                      <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="btn-text">Verificar firma</span>
                  </div>
                </button>
              </div>

              <div class="secondary-actions">
                <button id="restartSignProcessBtn" class="btn-outline restart-btn">
                  <div class="btn-content">
                    <span class="btn-text">Firmar otro documento</span>
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4m-4 4a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Sección de Verificar con diseño moderno -->
      <section id="verifySection">
        <h2>Verificar Aval</h2>
        <p class="section-desc">
          Verifica la autenticidad y la integridad de un documento PDF avalado
          electrónicamente por un profesor o tutor.
        </p>

        <!-- Indicador de pasos moderno -->
        <div id="verifyStepIndicator" class="step-indicator">
          <div class="step active" data-step="1" data-label="Avalador"></div>
          <div class="step" data-step="2" data-label="Aval firmado"></div>
          <div class="step" data-step="3" data-label="Original"></div>
          <div class="step" data-step="4" data-label="Resultado"></div>
        </div>

        <!-- Paso 1: Selección de profesor -->
        <div id="verifyStep1" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Método de Verificación</h3>
              <p class="step-description">Selecciona el método de verificación que prefieres usar</p>
            </div>
          </div>

          <div class="step-main-content">
            <div class="verify-switch-container">
              <label class="verify-switch-label">
                <span id="manualLabel" class="switch-label">Manual</span>
                <input type="checkbox" id="verifyModeSwitch" checked />
                <span class="verify-switch-slider"></span>
                <span id="autoLabel" class="switch-label-active">Automático</span>
              </label>
            </div>
          <div id="manualVerifyOption" style="display: none;">
            <div class="verify-description">
              <strong>Manual:</strong> Busca y selecciona manualmente el
              avalador que firmó el documento.
            </div>
            <form id="verifyProfesorForm">
              <!-- Sistema de búsqueda y filtrado de profesores -->
              <div class="professor-search-container">
                <div class="search-controls">
                  <div class="search-input-wrapper">
                    <input
                      type="text"
                      id="professorSearchInput"
                      placeholder="Buscar profesor por nombre..."
                      class="search-input"
                    />
                    <span class="search-icon">
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <circle
                          cx="11"
                          cy="11"
                          r="8"
                          stroke="#9CA3AF"
                          stroke-width="2"
                        />
                        <path
                          d="m21 21-4.35-4.35"
                          stroke="#9CA3AF"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </span>
                  </div>
                  <div class="filter-controls">
                    <select id="sortOrder" class="sort-select">
                      <option value="asc">A-Z</option>
                      <option value="desc">Z-A</option>
                    </select>
                    <button
                      type="button"
                      id="clearSearch"
                      class="clear-btn"
                      title="Limpiar búsqueda"
                    >
                      ×
                    </button>
                  </div>
                </div>
                <!-- Lista de profesores -->
                <div class="professors-list" id="professorsList">
                  <div class="loading-professors">
                    <span class="loader-small"></span>
                    <span>Cargando Avaladores...</span>
                  </div>
                </div>
                </div>
              </div>
            </form>
          </div>
          
          <!-- Sección automática -->
          <div id="autoVerifyOption">
            <div class="verify-description">
              <strong>Automático:</strong> Sube el documento firmado y el
              sistema detectará automáticamente quién lo firmó.
            </div>
            <form id="autoDetectForm">
              <div class="auto-detect-container">
                <h4>
                  <svg
                    class="section-icon"
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <circle
                      cx="11"
                      cy="11"
                      r="8"
                      stroke="currentColor"
                      stroke-width="2"
                    />
                    <path
                      d="m21 21-4.35-4.35"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Detección Automática
                </h4>
                <p class="auto-detect-description">
                  Sube el documento firmado para detectar automáticamente quién
                  lo firmó.
                </p>
                <div class="file-input-container">
                  <div class="file-input-wrapper">
                    <input
                      type="file"
                      id="autoDetectFile"
                      accept=".pdf"
                      class="file-input"
                      aria-label="Seleccionar archivo PDF firmado para detección automática"
                    />
                    <label for="autoDetectFile" class="file-input-label">
                      <div class="file-input-icon"></div>
                      <span class="file-input-text"
                        >Subir documento firmado</span
                      >
                      <button class="file-input-button">
                        Detectar firmante
                      </button>
                    </label>
                  </div>
                </div>
                <div
                  id="autoDetectResult"
                  class="auto-detect-result"
                  style="display: none"
                ></div>
              </div>
            </form>
          </div>
          
          <!-- Campo de profesor seleccionado - Global para ambos modos -->
          <div class="selected-professor" id="selectedProfessor" style="display: none; margin-top: 24px;">
            <div class="selected-label">Avalador seleccionado:</div>
            <div class="selected-info">
              <span class="selected-name" id="selectedProfessorName"></span>
              <button type="button" id="changeProfessor" class="change-btn-circular" title="Cambiar profesor">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1 4v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>
          
          <!-- Botón global de continuar para ambos modos -->
          <div style="display: flex; justify-content: center; margin-top: 24px">
            <button
              type="button"
              id="continueVerifyStep1Btn"
              class="btn-primary"
              disabled
            >
              Continuar
              <svg
                class="btn-icon-right"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                aria-hidden="true"
              >
                <path
                  d="M6 12h12M14 8l4 4-4 4"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          </div>
        </div>

        <!-- Paso 2: Selección de archivo avalado -->
        <div id="verifyStep2" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 18v-6M9 15l3-3 3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Documento Avalado</h3>
              <p class="step-description">Selecciona el archivo PDF que fue firmado electrónicamente por el avalador</p>
            </div>
          </div>

          <div class="step-main-content">
            <form id="verifyAvalForm">
              <div class="upload-section">
                <div class="upload-content">
                  <h4 class="upload-title">Sube tu documento firmado</h4>
                  <p class="upload-subtitle">El archivo debe tener la extensión .pdf y contener la firma electrónica</p>
                  
                  <div class="modern-file-input-container">
                    <input
                      type="file"
                      id="signedFile"
                      accept=".pdf"
                      class="modern-file-input"
                      aria-label="Seleccionar archivo PDF firmado"
                      required
                    />
                    <label for="signedFile" class="modern-file-label">
                      <div class="file-label-content">
                        <div class="file-icon">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                          </svg>
                        </div>
                        <div class="file-text">
                          <span class="file-main-text">Haz clic para seleccionar archivo</span>
                          <span class="file-sub-text">o arrastra y suelta aquí</span>
                        </div>
                      </div>
                    </label>
                  </div>

                  <div class="file-info" id="signedFileInfo" style="display: none;">
                    <div class="file-info-content">
                      <div class="file-info-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                          <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </div>
                      <div class="file-details">
                        <div class="file-name" id="signedFileName"></div>
                        <div class="file-size" id="signedFileSize"></div>
                      </div>
                      <button type="button" class="file-remove-btn" onclick="clearSignedFile()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="step-actions">
                <button type="button" id="acceptAvalBtn" class="modern-btn primary" disabled>
                  <span class="btn-content">
                    <span class="btn-text">Continuar con verificación</span>
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Paso 3: Selección de archivo original -->
        <div id="verifyStep3" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                  <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                  <circle cx="12" cy="15" r="1" fill="currentColor"/>
                  <path d="M9 12h6" stroke="currentColor" stroke-width="1.5"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Documento Original</h3>
              <p class="step-description">Selecciona el archivo PDF original (sin firmar) para comparar con el documento avalado</p>
            </div>
          </div>

          <div class="step-main-content">
            <form id="verifyOriginalForm">
              <div class="upload-section">
                <div class="upload-content">
                  <h4 class="upload-title">Sube el documento original</h4>
                  <p class="upload-subtitle">Debe ser la versión sin firmar del documento que quieres verificar</p>
                  
                  <div class="modern-file-input-container">
                    <input
                      type="file"
                      id="originalFile"
                      accept=".pdf"
                      class="modern-file-input"
                      aria-label="Seleccionar archivo PDF original"
                      required
                    />
                    <label for="originalFile" class="modern-file-label">
                      <div class="file-label-content">
                        <div class="file-icon">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                          </svg>
                        </div>
                        <div class="file-text">
                          <span class="file-main-text">Haz clic para seleccionar archivo</span>
                          <span class="file-sub-text">o arrastra y suelta aquí</span>
                        </div>
                      </div>
                    </label>
                  </div>

                  <div class="file-info" id="originalFileInfo" style="display: none;">
                    <div class="file-info-content">
                      <div class="file-info-icon">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                          <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </div>
                      <div class="file-details">
                        <div class="file-name" id="originalFileName"></div>
                        <div class="file-size" id="originalFileSize"></div>
                      </div>
                      <button type="button" class="file-remove-btn" onclick="clearOriginalFile()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="verification-notice">
                <div class="notice-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    <path d="m9 12 2 2 4-4" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="notice-content">
                  <h5>Verificación de integridad</h5>
                  <p>Compararemos este documento original con el archivo firmado para verificar que no haya sido alterado.</p>
                </div>
              </div>

              <div class="step-actions">
                <button type="button" id="acceptOriginalBtn" class="modern-btn success" disabled>
                  <span class="btn-content">
                    <span class="btn-text">Iniciar verificación</span>
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                      <path d="m9 12 2 2 4-4" stroke="currentColor" stroke-width="2"/>
                    </svg>
                  </span>
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Paso 4: Resultado de verificación -->
        <div id="verifyStep4" class="step-content" style="display: none">
          <div class="step-header-container">
            <div class="step-icon-container">
              <div class="step-icon-wrapper result-icon">
                <svg class="step-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                  <path d="m9 12 2 2 4-4" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
            </div>
            <div class="step-header-content">
              <h3 class="step-title">Resultado de Verificación</h3>
              <p class="step-description">Aquí se muestra el resultado completo del proceso de verificación</p>
            </div>
          </div>

          <div class="step-main-content">
            <div class="verification-result-container">
              <div id="verificationResult"></div>
            </div>

            <div class="result-actions-container">
              <div class="primary-actions">
                <button id="continueVerifyBtn" class="modern-btn primary" style="display: none">
                  <span class="btn-content">
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2"/>
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="btn-text">Verificar otro documento</span>
                  </span>
                </button>
                
                <button id="retryKeyBtn" class="modern-btn warning" style="display: none">
                  <span class="btn-content">
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M1 4v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M3.51 15a9 9 0 102.13-9.36L1 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="btn-text">Intentar con otro avalador</span>
                  </span>
                </button>
              </div>

              <div class="secondary-actions">
                <button id="restartVerifyProcessBtn" class="modern-btn secondary" style="display: none">
                  <span class="btn-content">
                    <svg class="btn-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path d="M1 4v6h6" stroke="currentColor" stroke-width="2"/>
                      <path d="M3.51 15a9 9 0 102.13-9.36L1 10" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="btn-text">Comenzar nuevo proceso</span>
                  </span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="perfilSection">
        <h2>Gestión de Perfil</h2>
        <p class="section-desc">
          Administra tu cuenta, configuraciones y personaliza tu experiencia.
          Gestiona tus llaves digitales, configuraciones de cifrado y más.
        </p>

        <!-- SISTEMA DE PESTAÑAS -->
        <div class="perfil-tabs-container">
          <!-- MENÚ DE PESTAÑAS -->
          <div class="perfil-tabs-menu">
            <div class="perfil-tab-btn active" data-tab="datos-personales">
              <div class="tab-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <circle
                    cx="12"
                    cy="7"
                    r="4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="tab-info">
                <div class="tab-title">Datos Personales</div>
                <div class="tab-desc">Información del perfil</div>
              </div>
            </div>

            <div class="perfil-tab-btn" data-tab="historial-firma">
              <div class="tab-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <polyline
                    points="14,2 14,8 20,8"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M10 13h4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <path
                    d="M10 17h4"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                  <circle cx="8" cy="13" r="1" fill="currentColor" />
                  <circle cx="8" cy="17" r="1" fill="currentColor" />
                </svg>
              </div>
              <div class="tab-info">
                <div class="tab-title">Historial de Firma</div>
                <div class="tab-desc">Documentos firmados</div>
              </div>
            </div>

            <div class="perfil-tab-btn" data-tab="gestion-llaves">
              <div class="tab-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <rect
                    x="8"
                    y="6"
                    width="13"
                    height="12"
                    rx="1"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <circle cx="10" cy="12" r="1" fill="currentColor" />
                  <path
                    d="M3 15a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-1z"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <path
                    d="M7 15h1"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
              <div class="tab-info">
                <div class="tab-title">Gestión de Llaves</div>
                <div class="tab-desc">Crear y administrar llaves</div>
              </div>
            </div>

            <div class="perfil-tab-btn" data-tab="configuracion-cifrado">
              <div class="tab-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <rect
                    x="3"
                    y="11"
                    width="18"
                    height="11"
                    rx="2"
                    ry="2"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <circle
                    cx="12"
                    cy="16"
                    r="1"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M7 11V7a5 5 0 0 1 10 0v4"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
              </div>
              <div class="tab-info">
                <div class="tab-title">Configuración de Cifrado</div>
                <div class="tab-desc">Algoritmos de seguridad</div>
              </div>
            </div>

            <!-- CONFIGURACIONES AVANZADAS -->
            <div class="perfil-tab-btn" data-tab="configuraciones-avanzadas">
              <div class="tab-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div class="tab-info">
                <div class="tab-title">Configuraciones Avanzadas</div>
                <div class="tab-desc">Panel de administración</div>
              </div>
            </div>
          </div>

          <!-- CONTENIDO DE PESTAÑAS -->
          <div class="perfil-tabs-content">
            <!-- TAB 1: DATOS PERSONALES -->
            <div class="perfil-tab-content active" id="tab-datos-personales">
              <div class="tab-content-header">
                <h3>
                  Datos Personales
                </h3>
                <p>Actualiza tu información personal y foto de perfil</p>
              </div>

              <div class="datos-personales-grid">
                <div class="perfil-photo-section">
                  <div class="perfil-photo" onclick="selectProfilePhoto()">
                    <div class="perfil-photo-placeholder">
                      <svg
                        width="40"
                        height="40"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <path
                          d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                        <circle
                          cx="12"
                          cy="13"
                          r="4"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </div>
                  </div>
                  <button
                    class="photo-upload-btn"
                    onclick="selectProfilePhoto()"
                  >
                    Cambiar Foto
                  </button>
                  <input
                    type="file"
                    id="profilePhotoInput"
                    accept="image/*"
                    style="display: none"
                    onchange="handleProfilePhoto(event)"
                  />
                </div>

                <div class="datos-form">
                  <div class="form-group">
                    <label for="userName">Nombre Completo</label>
                    <input
                      type="text"
                      id="userName"
                      placeholder="Tu nombre completo"
                    />
                  </div>
                  <div class="form-group">
                    <label for="userEmail">Correo Electrónico</label>
                    <input
                      type="email"
                      id="userEmail"
                      placeholder="tu@correo.com"
                    />
                  </div>
                  <div class="form-group">
                    <label for="userOrganization">Organización</label>
                    <input
                      type="text"
                      id="userOrganization"
                      placeholder="Universidad, Empresa, etc."
                    />
                  </div>
                  <div class="form-group">
                    <label for="userBio">Biografía</label>
                    <textarea
                      id="userBio"
                      placeholder="Breve descripción sobre ti..."
                      rows="3"
                    ></textarea>
                  </div>
                  
                  <!-- Campos adicionales de información personal -->
                  <div class="form-group">
                    <label for="userPhone">Teléfono</label>
                    <input
                      type="tel"
                      id="userPhone"
                      placeholder="+57 300 123 4567"
                    />
                  </div>
                  
                  <div class="form-group">
                    <label for="userAddress">Dirección</label>
                    <textarea
                      id="userAddress"
                      placeholder="Dirección completa..."
                      rows="2"
                    ></textarea>
                  </div>
                  
                  <!-- Información académica/profesional -->
                  <div class="form-row">
                    <div class="form-group">
                      <label for="userPosition">Cargo</label>
                      <input
                        type="text"
                        id="userPosition"
                        placeholder="Profesor, Director, etc."
                      />
                    </div>
                    <div class="form-group">
                      <label for="userDepartment">Departamento</label>
                      <input
                        type="text"
                        id="userDepartment"
                        placeholder="Facultad o departamento"
                      />
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label for="userDegree">Grado Académico</label>
                    <select id="userDegree">
                      <option value="">Selecciona tu grado académico</option>
                      <option value="Técnico">Técnico</option>
                      <option value="Tecnólogo">Tecnólogo</option>
                      <option value="Profesional">Profesional</option>
                      <option value="Especialista">Especialista</option>
                      <option value="Magíster">Magíster</option>
                      <option value="Doctor">Doctor</option>
                      <option value="Post-Doctor">Post-Doctor</option>
                    </select>
                  </div>
                  
                  <!-- Configuraciones -->
                  <div class="form-section-title">
                    <h4>Configuraciones Adicionales</h4>
                  </div>
                  
                  <div class="form-row">
                    <div class="form-group">
                      <label for="userTimezone">Zona Horaria</label>
                      <select id="userTimezone">
                        <option value="America/Bogota">América/Bogotá (UTC-5)</option>
                        <option value="America/Mexico_City">América/Ciudad de México (UTC-6)</option>
                        <option value="America/New_York">América/Nueva York (UTC-5/-4)</option>
                        <option value="Europe/Madrid">Europa/Madrid (UTC+1/+2)</option>
                        <option value="Europe/London">Europa/Londres (UTC+0/+1)</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="userLanguage">Idioma</label>
                      <select id="userLanguage">
                        <option value="es">Español</option>
                        <option value="en">English</option>
                        <option value="fr">Français</option>
                      </select>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <div class="checkbox-group">
                      <label class="checkbox-label">
                        <input type="checkbox" id="emailNotifications" />
                        <span class="checkmark"></span>
                        Recibir notificaciones por correo electrónico
                      </label>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <div class="checkbox-group">
                      <label class="checkbox-label">
                        <input type="checkbox" id="twoFactorAuth" />
                        <span class="checkmark"></span>
                        Habilitar autenticación de dos factores (2FA)
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <div class="tab-actions">
                <button class="save-btn" onclick="saveUserData()">
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    style="margin-right: 8px"
                  >
                    <path
                      d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <polyline
                      points="17,21 17,13 7,13 7,21"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <polyline
                      points="7,3 7,8 15,8"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Guardar Datos
                </button>
              </div>
            </div>

            <!-- TAB 2: HISTORIAL DE FIRMA -->
            <div class="perfil-tab-content" id="tab-historial-firma">
              <div class="tab-content-header">
                <h3>
                  Historial de Firma
                </h3>
                <p>Consulta el historial completo de documentos firmados</p>
              </div>

              <div class="historial-container">
                <!-- Filtros de búsqueda -->
                <div class="historial-filters">
                  <div class="filter-row">
                    <div class="filter-group">
                      <label for="filtro-fecha-inicio"
                        >Filtrar por fecha:</label
                      >
                      <input
                        type="date"
                        id="filtro-fecha-inicio"
                        class="date-input"
                      />
                      <span class="date-separator">hasta</span>
                      <input
                        type="date"
                        id="filtro-fecha-fin"
                        class="date-input"
                      />
                    </div>
                    <div class="filter-group">
                      <label for="filtro-estado">Estado:</label>
                      <select id="filtro-estado" class="status-select">
                        <option value="">Todos</option>
                        <option value="firmado">Firmado</option>
                        <option value="verificado">Verificado</option>
                        <option value="pendiente">Pendiente</option>
                      </select>
                    </div>
                    <button class="filter-btn">
                      <svg
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                      >
                        <circle
                          cx="11"
                          cy="11"
                          r="8"
                          stroke="currentColor"
                          stroke-width="2"
                        />
                        <path
                          d="M21 21l-4.35-4.35"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                        />
                      </svg>
                      Filtrar
                    </button>
                  </div>
                </div>

                <!-- Lista de documentos -->
                <div class="historial-list" id="historial-documentos">
                  <div class="historial-item">
                    <div class="historial-info">
                      <div class="documento-icon">
                        <svg
                          width="24"
                          height="24"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                            fill="currentColor"
                          />
                        </svg>
                      </div>
                      <div class="documento-details">
                        <h4 class="documento-nombre">
                          Contrato_de_trabajo_2024.pdf
                        </h4>
                        <div class="documento-meta">
                          <span class="fecha"
                            >Firmado el 15/01/2024 - 14:30</span
                          >
                          <span class="estado estado-firmado">Firmado</span>
                        </div>
                        <div class="documento-firma-info">
                          <span class="firma-tipo">Firma RSA-2048</span>
                          <span class="firma-validez"
                            >Válida hasta: 15/01/2025</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="historial-actions">
                      <button
                        class="action-btn descargar-btn"
                        title="Descargar documento firmado"
                      >
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <polyline
                            points="7,10 12,15 17,10"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <line
                            x1="12"
                            y1="15"
                            x2="12"
                            y2="3"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                      <button
                        class="action-btn verificar-btn"
                        title="Verificar firma"
                      >
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M9 12l2 2 4-4"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <circle
                            cx="12"
                            cy="12"
                            r="9"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                        </svg>
                      </button>
                      <button class="action-btn info-btn" title="Ver detalles">
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <circle
                            cx="12"
                            cy="12"
                            r="10"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <line
                            x1="12"
                            y1="16"
                            x2="12"
                            y2="12"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <line
                            x1="12"
                            y1="8"
                            x2="12.01"
                            y2="8"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                        </svg>
                      </button>
                    </div>
                  </div>

                  <!-- Ejemplo de documento verificado -->
                  <div class="historial-item">
                    <div class="historial-info">
                      <div class="documento-icon">
                        <svg
                          width="24"
                          height="24"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                            fill="currentColor"
                          />
                        </svg>
                      </div>
                      <div class="documento-details">
                        <h4 class="documento-nombre">
                          Acuerdo_confidencialidad.pdf
                        </h4>
                        <div class="documento-meta">
                          <span class="fecha"
                            >Firmado el 12/01/2024 - 09:15</span
                          >
                          <span class="estado estado-verificado"
                            >Verificado</span
                          >
                        </div>
                        <div class="documento-firma-info">
                          <span class="firma-tipo">Firma RSA-2048</span>
                          <span class="firma-validez"
                            >Válida hasta: 12/01/2025</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="historial-actions">
                      <button
                        class="action-btn descargar-btn"
                        title="Descargar documento firmado"
                      >
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <polyline
                            points="7,10 12,15 17,10"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <line
                            x1="12"
                            y1="15"
                            x2="12"
                            y2="3"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                      <button
                        class="action-btn verificar-btn"
                        title="Verificar firma"
                      >
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <path
                            d="M9 12l2 2 4-4"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                          <circle
                            cx="12"
                            cy="12"
                            r="9"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                        </svg>
                      </button>
                      <button class="action-btn info-btn" title="Ver detalles">
                        <svg
                          width="20"
                          height="20"
                          viewBox="0 0 24 24"
                          fill="none"
                        >
                          <circle
                            cx="12"
                            cy="12"
                            r="10"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <line
                            x1="12"
                            y1="16"
                            x2="12"
                            y2="12"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                          <line
                            x1="12"
                            y1="8"
                            x2="12.01"
                            y2="8"
                            stroke="currentColor"
                            stroke-width="2"
                          />
                        </svg>
                      </button>
                    </div>
                  </div>

                  <!-- Mensaje cuando no hay documentos -->
                  <div class="no-documentos" style="display: none">
                    <svg
                      width="48"
                      height="48"
                      viewBox="0 0 24 24"
                      fill="none"
                      style="opacity: 0.5; margin-bottom: 15px"
                    >
                      <path
                        d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                        fill="currentColor"
                      />
                    </svg>
                    <p>No se encontraron documentos firmados</p>
                    <p class="sub-message">
                      Los documentos que firmes aparecerán aquí
                    </p>
                  </div>
                </div>

                <!-- Paginación -->
                <div class="historial-pagination">
                  <button class="pagination-btn" id="prev-page">
                    Anterior
                  </button>
                  <span class="page-info">Página 1 de 3</span>
                  <button class="pagination-btn" id="next-page">
                    Siguiente
                  </button>
                </div>
              </div>
            </div>

            <!-- TAB 3: GESTIÓN DE LLAVES -->
            <div class="perfil-tab-content" id="tab-gestion-llaves">
              <div class="tab-content-header">
                <h3>
                  Gestión de Llaves
                </h3>
                <p>Administra tus llaves digitales para firmar documentos</p>
              </div>

              <div class="keys-summary">
                <div class="keys-info">
                  <div class="keys-stats">
                    <div class="key-stat-item">
                      <div class="keys-count total-keys" id="totalKeysCount">
                        0
                      </div>
                      <div class="keys-count-label">Total de Llaves</div>
                    </div>
                    <div class="key-stat-item">
                      <div class="keys-count active-keys" id="activeKeysCount">
                        0
                      </div>
                      <div class="keys-count-label">Disponibles</div>
                    </div>
                    <div class="key-stat-item">
                      <div
                        class="keys-count expired-keys"
                        id="expiredKeysCount"
                      >
                        0
                      </div>
                      <div class="keys-count-label">Expiradas</div>
                    </div>
                    <div class="key-stat-item active-key-status">
                      <div
                        class="active-key-info no-active-key"
                        id="activeKeyInfo"
                      >
                        <div
                          class="active-key-indicator"
                          id="activeKeyIndicator"
                        ></div>
                        <div class="active-key-content">
                          <div class="active-key-text">Llave Activa:</div>
                          <div class="active-key-name" id="activeKeyName">
                            No hay llave activa
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div
                class="form-group key-name-with-button"
                style="margin-bottom: 20px"
              >
                <label for="keyNameInput">Nombre para nueva llave:</label>
                <div class="key-name-input-container">
                  <input
                    type="text"
                    id="keyNameInput"
                    placeholder="Ej: Llave para tesis, Llave personal... (opcional)"
                  />
                  <button
                    class="create-key-btn inline-btn"
                    onclick="showCreateKeyModal()"
                  >
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      style="margin-right: 8px"
                    >
                      <line
                        x1="12"
                        y1="5"
                        x2="12"
                        y2="19"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                      <line
                        x1="5"
                        y1="12"
                        x2="19"
                        y2="12"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                      />
                    </svg>
                    Nueva Llave
                  </button>
                </div>
              </div>

              <div class="keys-list-container">
                <h4>
                  Mis Llaves Digitales
                </h4>
                <div class="keys-list" id="profileKeysList">
                  <!-- Las llaves se cargarán dinámicamente -->
                </div>
              </div>
            </div>

            <!-- TAB 4: CONFIGURACIÓN DE CIFRADO -->
            <div class="perfil-tab-content" id="tab-configuracion-cifrado">
              <div class="tab-content-header">
                <h3>Configuración de Cifrado</h3>
                <p>
                  Selecciona el algoritmo de cifrado para proteger tus llaves
                </p>
              </div>

              <div class="encryption-config">
                <div class="encryption-current">
                  <div class="encryption-current-label">Algoritmo Actual</div>
                  <div class="encryption-current-value" id="currentEncryption">
                    AES-256-CBC
                  </div>
                </div>

                <div class="encryption-options">
                  <div
                    class="encryption-option selected"
                    data-encryption="aes-256-cbc"
                  >
                    <div class="encryption-option-title">AES-256-CBC</div>
                    <div class="encryption-option-desc">
                      Recomendado - Máxima seguridad
                    </div>
                  </div>
                  <div class="encryption-option" data-encryption="aes-192-cbc">
                    <div class="encryption-option-title">AES-192-CBC</div>
                    <div class="encryption-option-desc">
                      Estándar - Buena seguridad
                    </div>
                  </div>
                  <div class="encryption-option" data-encryption="aes-128-cbc">
                    <div class="encryption-option-title">AES-128-CBC</div>
                    <div class="encryption-option-desc">
                      Rápido - Seguridad básica
                    </div>
                  </div>
                </div>

                <div class="tab-actions">
                  <button id="confirmEncryptionTypeBtn" class="save-btn">
                    <svg
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      style="margin-right: 8px"
                    >
                      <rect
                        x="3"
                        y="11"
                        width="18"
                        height="11"
                        rx="2"
                        ry="2"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                      <circle cx="12" cy="16" r="1" fill="currentColor" />
                      <path
                        d="M7 11V7a5 5 0 0 1 10 0v4"
                        stroke="currentColor"
                        stroke-width="2"
                      />
                    </svg>
                    Aplicar Configuración
                  </button>
                </div>

                <p id="encryptionTypeMsg" class="encryption-msg">
                  <!-- Mensaje dinámico -->
                </p>
              </div>
            </div>

            <!-- TAB 6: CONFIGURACIONES AVANZADAS -->
            <div class="perfil-tab-content" id="tab-configuraciones-avanzadas">
              <div class="tab-content-header">
                <h3>
                  Configuraciones del Sistema
                </h3>
                <p>
                  Personaliza la experiencia del sitio y accede a herramientas avanzadas de administración.
                </p>
              </div>

              <!-- CONFIGURACIONES ORGANIZADAS POR CATEGORÍAS -->
              <div class="advanced-config-panel">

                <!-- CATEGORÍA 1: ADMINISTRACIÓN DEL SITIO (Solo Owner) -->
                <div class="config-category" id="ownerAdminCategory" style="display: none;">
                  <div class="category-header">
                    <h4>
                      Administración del Sitio
                    </h4>
                    <span class="category-badge owner">Solo Propietario</span>
                  </div>
                  
                  <div class="admin-quick-actions">
                    <div class="quick-action-card" onclick="openAdminPanel()">
                      <div class="action-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                          <rect x="3" y="3" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                          <circle cx="8.5" cy="8.5" r="1.5" stroke="currentColor" stroke-width="2"/>
                          <path d="M21 15l-5-5L5 21" stroke="currentColor" stroke-width="2"/>
                        </svg>
                      </div>
                      <div class="action-content">
                        <h5>Panel de Administración Completo</h5>
                        <p>Accede al dashboard principal con todas las herramientas de gestión</p>
                      </div>
                      <div class="action-arrow">→</div>
                    </div>
                  </div>
                </div>

                <!-- CATEGORÍA 2: CONFIGURACIONES GENERALES -->
                <div class="config-category">
                  <div class="category-header">
                    <h4>
                      Configuraciones de Apariencia
                    </h4>
                  </div>

                  <div class="settings-grid">
                    <!-- Modo Oscuro -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Modo Oscuro</div>
                        <div class="setting-description">Activa el tema oscuro para reducir la fatiga visual</div>
                      </div>
                      <div class="toggle-switch" onclick="toggleTheme('dark')">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>

                    <!-- Animaciones -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Animaciones Suaves</div>
                        <div class="setting-description">Habilita transiciones y efectos visuales</div>
                      </div>
                      <div class="toggle-switch active" onclick="toggleSetting(this)">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>

                    <!-- Notificaciones -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Notificaciones del Sistema</div>
                        <div class="setting-description">Recibe alertas sobre el estado del sistema</div>
                      </div>
                      <div class="toggle-switch active" onclick="toggleSetting(this)">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>

                    <!-- Autoguardado -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Autoguardado</div>
                        <div class="setting-description">Guarda automáticamente los cambios en formularios</div>
                      </div>
                      <div class="toggle-switch active" onclick="toggleSetting(this)">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>

                    <!-- Compresión de archivos -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Compresión de Archivos</div>
                        <div class="setting-description">Optimiza el tamaño de los PDFs generados</div>
                      </div>
                      <div class="toggle-switch" onclick="toggleSetting(this)">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>

                    <!-- Validación extendida -->
                    <div class="setting-item">
                      <div class="setting-info">
                        <div class="setting-label">Validación Extendida</div>
                        <div class="setting-description">Verificación adicional en procesos de firma</div>
                      </div>
                      <div class="toggle-switch active" onclick="toggleSetting(this)">
                        <div class="toggle-handle"></div>
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>
      </section>

      <section id="contactoSection">
        <h2>Contacto</h2>
        <p class="section-desc">
          Si tienes preguntas o necesitas ayuda, contáctanos.
        </p>
        <form id="contactForm">
          <label for="name">Nombre:</label>
          <input type="text" id="name" name="name" required />

          <label for="email">Correo Electrónico:</label>
          <input type="email" id="email" name="email" required />

          <label for="message">Mensaje:</label>
          <textarea id="message" name="message" required></textarea>

          <button type="submit">
            <svg
              class="btn-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
            >
              <path
                d="M22 2L11 13"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M22 2L15 22l-4-9-9-4 18-7z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Enviar
          </button>
        </form>
        <p
          id="contactMessage"
          style="display: none; color: green; margin: 25px"
        >
          Mensaje enviado correctamente. Nos pondremos en contacto contigo
          pronto.
        </p>
      </section>
    </main>

    <footer class="fixed_footer">
      <div class="footer-cta">
        <h2 class="cta-title">¿Listo para proteger tus documentos?</h2>
        <p class="cta-description">
          Únete a la nueva era de certificación digital para investigación y
          academia. Firma, avala y verifica con seguridad profesional.
        </p>
        <div class="cta-buttons">
          <button class="cta-btn primary" onclick="window.openTutorial?.()">
            Ver tutorial de uso
          </button>
        </div>
        <p class="cta-meta" aria-label="Nota de privacidad">
          <svg
            width="14"
            height="14"
            viewBox="0 0 24 24"
            fill="none"
            aria-hidden="true"
            style="vertical-align: -2px; margin-right: 6px"
          >
            <rect
              x="3"
              y="11"
              width="18"
              height="11"
              rx="2"
              ry="2"
              stroke="currentColor"
              stroke-width="2"
            />
            <circle
              cx="12"
              cy="16"
              r="1"
              stroke="currentColor"
              stroke-width="2"
            />
            <path
              d="M7 11V7a5 5 0 0 1 10 0v4"
              stroke="currentColor"
              stroke-width="2"
            />
          </svg>
          Tus archivos nunca se almacenan permanentemente.
        </p>
      </div>
      <div class="footer-divider" role="separator" aria-hidden="true"></div>
      <p>&copy; 2025 <span id="footerCompanyName" class="footer-institution" data-footer-institution>Pruebas Digitales</span>. Todos los derechos reservados.</p>
    </footer>

    <!-- Scripts de frontend -->
    <!-- Sistema de notificaciones (debe cargarse primero) -->
    <script src="/scripts/frontend/notifications.js"></script>
    <script src="/scripts/frontend/keys.frontend.js"></script>
    <script src="/scripts/frontend/auth.frontend.js"></script>
    <script src="/scripts/frontend/userKeysModal.js"></script>
    <script src="/scripts/frontend/auth.frontend.js"></script>
    <script src="/scripts/frontend/keyPassword.frontend.js"></script>
    <script src="/scripts/frontend/deleteKey.frontend.js"></script>
    <script src="/scripts/frontend/signSteps.js"></script>
    <script src="/scripts/frontend/verifySteps.js"></script>
    <script src="/scripts/frontend/frontend.js"></script>
    <script src="/scripts/frontend/profileEncryption.frontend.js"></script>
    <script src="/scripts/frontend/profile.frontend.js"></script>
    <script src="/scripts/frontend/mobileHamburger.frontend.js"></script>
    <script src="/scripts/utils/tutorial.js"></script>
    
    <!-- Sistema de Temas Dinámicos -->
    <script src="/scripts/utils/themeManager.js"></script>
    <script src="/scripts/frontend/visualConfig.frontend.js"></script>
    <script src="/scripts/frontend/inicioTimelineReveal.js"></script>
  </body>
</html>
